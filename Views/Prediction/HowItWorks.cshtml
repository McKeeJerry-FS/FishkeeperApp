@{
    ViewData["Title"] = "How Water Chemistry Predictions Work";
}

<!-- 
    ======================================================================================
    EDUCATIONAL PAGE: HOW MACHINE LEARNING PREDICTIONS WORK
    ======================================================================================
    
    This page explains the machine learning concepts to users in plain English.
    Goal: Help users understand what predictions mean and how to use them effectively.
    ======================================================================================
-->

<div class="container mt-4">
    <!-- Page Header -->
    <div class="row mb-4">
        <div class="col-md-12">
            <h1 class="display-4">
                <i class="fas fa-graduation-cap"></i> How Water Chemistry Predictions Work
            </h1>
            <p class="lead text-muted">
                Understanding the machine learning behind your aquarium forecasts
            </p>
        </div>
    </div>

    <!-- What is Machine Learning? -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h3 class="mb-0">
                        <i class="fas fa-brain"></i> What is Machine Learning?
                    </h3>
                </div>
                <div class="card-body">
                    <p class="lead">
                        Machine Learning is teaching computers to find patterns in data and make predictions.
                    </p>

                    <h5>Simple Analogy:</h5>
                    <p>
                        Imagine tracking your tank's pH every 3 days:
                    </p>
                    <div class="bg-light p-3 mb-3">
                        <strong>Your Readings:</strong>
                        <br>
                        Day 0: pH 8.2
                        <br>
                        Day 3: pH 8.1
                        <br>
                        Day 6: pH 8.0
                        <br>
                        Day 9: pH 7.9
                        <br>
                        Day 12: pH 7.8
                    </div>
                    <p>
                        <strong>You notice a pattern:</strong> pH is dropping by about 0.1 every 3 days.
                    </p>
                    <p>
                        <strong>You predict:</strong> "If this continues, pH will be about 7.7 on day 15."
                    </p>
                    <p>
                        <strong>That's machine learning!</strong> The computer does exactly this, but with mathematical
                        precision.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- How We Make Predictions -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h3 class="mb-0">
                        <i class="fas fa-cogs"></i> Our Prediction Process
                    </h3>
                </div>
                <div class="card-body">
                    <h5>Step-by-Step:</h5>
                    <ol class="lead">
                        <li class="mb-3">
                            <strong>Collect Your Data</strong>
                            <p class="mb-0">
                                We gather all your historical water test results from the database.
                                <br>
                                <small class="text-muted">
                                    Need: At least 10-15 tests for reliable predictions
                                </small>
                            </p>
                        </li>
                        <li class="mb-3">
                            <strong>Find the Pattern (Linear Regression)</strong>
                            <p class="mb-0">
                                We plot your data points on a graph and find the "best fit" straight line through them.
                                This line represents the trend.
                                <br>
                                <small class="text-muted">
                                    Math: y = mx + b (slope-intercept form)
                                </small>
                            </p>
                        </li>
                        <li class="mb-3">
                            <strong>Calculate the Trend</strong>
                            <p class="mb-0">
                                The slope of the line tells us how fast values are changing.
                                <br>
                                <small class="text-muted">
                                    Example: Slope of -0.033 means dropping by 0.033 per day
                                </small>
                            </p>
                        </li>
                        <li class="mb-3">
                            <strong>Predict the Future</strong>
                            <p class="mb-0">
                                We extend the trend line forward to estimate future values.
                                <br>
                                <small class="text-muted">
                                    Formula: future_value = current_value + (slope × days_ahead)
                                </small>
                            </p>
                        </li>
                        <li class="mb-3">
                            <strong>Measure Confidence</strong>
                            <p class="mb-0">
                                We calculate how well your data fits the trend line (R² score).
                                <br>
                                <small class="text-muted">
                                    R² = 1.0 means perfect fit, R² = 0.0 means random data
                                </small>
                            </p>
                        </li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <!-- Understanding the Numbers -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h3 class="mb-0">
                        <i class="fas fa-chart-bar"></i> Understanding the Numbers
                    </h3>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h5>Confidence Score</h5>
                            <p>
                                This is the R² (R-squared) value from linear regression.
                                It measures how well your data fits a straight line pattern.
                            </p>
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Score</th>
                                        <th>Meaning</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>0.9 - 1.0</td>
                                        <td>Excellent - Very reliable</td>
                                    </tr>
                                    <tr>
                                        <td>0.7 - 0.9</td>
                                        <td>Good - Reliable trend</td>
                                    </tr>
                                    <tr>
                                        <td>0.5 - 0.7</td>
                                        <td>Fair - General direction</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            < 0.5</td>
                                                <td>Low - Data too random</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="col-md-6">
                                    <h5>Rate of Change</h5>
                                    <p>
                                        How much the parameter changes per day on average.
                                    </p>
                                    <div class="bg-light p-3">
                                        <strong>Example:</strong>
                                        <br>
                                        Rate of change: -0.05 pH/day
                                        <br>
                                        Current pH: 8.2
                                        <br>
                                        Prediction for 7 days: 8.2 + (-0.05 × 7) = 7.85
                                    </div>
                                    <p class="mt-3">
                                        <small>
                                            <strong>Positive rate:</strong> Value increasing
                                            <br>
                                            <strong>Negative rate:</strong> Value decreasing
                                            <br>
                                            <strong>Near zero:</strong> Value stable
                                        </small>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Linear Regression Visual Explanation -->
            <div class="row mb-4">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header bg-warning">
                            <h3 class="mb-0">
                                <i class="fas fa-chart-line"></i> Linear Regression Explained
                            </h3>
                        </div>
                        <div class="card-body">
                            <h5>What is Linear Regression?</h5>
                            <p>
                                Linear regression finds the straight line that best fits your data points.
                                This line represents the overall trend in your measurements.
                            </p>

                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Visual Concept:</h6>
                                    <div class="bg-light p-4 text-center">
                                        <pre style="text-align: left;">
                                            8.4 |                    ○
                                            |               ○
                                            8.2 |          ○       /
                                            |     ○         /
                                            8.0 | ○          /
                                            |        /
                                            7.8 |    /
                                            |/
                                            +------------------
                                            0   5   10  15 Days
                                        </pre>
                                        <p class="mb-0">
                                            <small>
                                                ○ = Your actual test results
                                                <br>
                                                / = Trend line (best fit)
                                            </small>
                                        </p>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h6>The Math (Simplified):</h6>
                                    <p>
                                        <strong>Line equation:</strong> y = mx + b
                                    </p>
                                    <ul>
                                        <li><strong>y</strong> = The parameter value (e.g., pH)</li>
                                        <li><strong>x</strong> = Time (days)</li>
                                        <li><strong>m</strong> = Slope (rate of change)</li>
                                        <li><strong>b</strong> = Y-intercept (starting value)</li>
                                    </ul>
                                    <div class="bg-light p-3">
                                        <strong>Example:</strong>
                                        <br>
                                        y = -0.033x + 8.2
                                        <br>
                                        <br>
                                        For day 15:
                                        <br>
                                        y = -0.033(15) + 8.2
                                        <br>
                                        y = -0.495 + 8.2
                                        <br>
                                        y = 7.705 (predicted pH)
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tips for Better Predictions -->
            <div class="row mb-4">
                <div class="col-md-12">
                    <div class="card border-primary">
                        <div class="card-header bg-primary text-white">
                            <h3 class="mb-0">
                                <i class="fas fa-lightbulb"></i> Tips for Better Predictions
                            </h3>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4">
                                    <h5>
                                        <i class="fas fa-calendar-check"></i> Test Regularly
                                    </h5>
                                    <p>
                                        Test at consistent intervals (e.g., every 3 days).
                                        Regular data creates clearer patterns.
                                    </p>
                                </div>
                                <div class="col-md-4">
                                    <h5>
                                        <i class="fas fa-database"></i> More Data = Better
                                    </h5>
                                    <p>
                                        The more historical tests you have, the more accurate predictions become.
                                        Aim for at least 15-20 tests.
                                    </p>
                                </div>
                                <div class="col-md-4">
                                    <h5>
                                        <i class="fas fa-chart-line"></i> Stable Trends
                                    </h5>
                                    <p>
                                        Predictions work best when parameters change steadily.
                                        Erratic values reduce confidence scores.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Limitations and Caveats -->
            <div class="row mb-4">
                <div class="col-md-12">
                    <div class="card border-danger">
                        <div class="card-header bg-danger text-white">
                            <h3 class="mb-0">
                                <i class="fas fa-exclamation-triangle"></i> Important Limitations
                            </h3>
                        </div>
                        <div class="card-body">
                            <p class="lead">
                                Predictions are estimates based on past patterns. They assume conditions remain similar.
                            </p>
                            <h5>Predictions May Be Less Accurate When:</h5>
                            <ul>
                                <li>You change feeding amounts or schedules</li>
                                <li>You add or remove livestock</li>
                                <li>Equipment fails or changes</li>
                                <li>You perform major maintenance (big water changes, substrate changes)</li>
                                <li>Environmental conditions change (temperature, humidity)</li>
                                <li>You add medications or supplements</li>
                            </ul>
                            <div class="alert alert-warning mb-0">
                                <strong>Remember:</strong> Use predictions as a guide to spot trends early.
                                Always continue regular water testing! Predictions don't replace testing.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Technical Details for Advanced Users -->
            <div class="row mb-4">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header bg-secondary text-white">
                            <h3 class="mb-0">
                                <i class="fas fa-code"></i> Technical Details
                            </h3>
                        </div>
                        <div class="card-body">
                            <h5>Algorithm: Ordinary Least Squares (OLS) Linear Regression</h5>
                            <p>
                                We use the "Least Squares" method to find the best fit line:
                            </p>
                            <ol>
                                <li>Calculate the mean (average) of x values (time) and y values (parameters)</li>
                                <li>Find the slope: m = Σ[(x - x̄)(y - ȳ)] / Σ[(x - x̄)²]</li>
                                <li>Find the intercept: b = ȳ - m × x̄</li>
                                <li>Calculate R²: R² = 1 - (SS_residual / SS_total)</li>
                            </ol>

                            <h5 class="mt-4">Configuration:</h5>
                            <ul>
                                <li><strong>Minimum data points:</strong> 10 readings</li>
                                <li><strong>Maximum history:</strong> 90 days</li>
                                <li><strong>Minimum confidence threshold:</strong> 0.5 (50% R²)</li>
                            </ul>

                            <h5 class="mt-4">Future Enhancements:</h5>
                            <p>
                                We may add additional algorithms:
                            </p>
                            <ul>
                                <li><strong>Weighted Moving Average:</strong> For stable parameters with occasional spikes</li>
                                <li><strong>Exponential Smoothing:</strong> For seasonal patterns</li>
                                <li><strong>Polynomial Regression:</strong> For non-linear trends</li>
                                <li><strong>ARIMA:</strong> For advanced time series forecasting</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Back Button -->
            <div class="row">
                <div class="col-md-12 text-center">
                    <a asp-action="Index" class="btn btn-primary btn-lg">
                        <i class="fas fa-arrow-left"></i> Back to Predictions
                    </a>
                </div>
            </div>
        </div>